
<div class="chat-wrapper">
	<div class="sidebar">

		<div class="sidebar-grid">
		    <%= image_tag("logo/Logo-good-small.png", id: "logo", style:"width: 200px") %>
		</div> 

		<% if user_signed_in? %>
			<div class="sidebar-grid">
	        	<h3 id="channel-heading"><%= current_user.username %>'s Current Chatrooms</h5>
	    	</div>
        	<hr>
	        <ul class="current-chatrooms">
	          <% current_user.chatrooms.public_channels.each do |chatroom| %>
	            <li><%= link_to chatroom.name, chatroom, data: {behavior: "chatroom-link", chatroom_id: chatroom.id} %></li>
	          <% end %>
	        </ul>
    	<% end %>
	
	<hr>

		<p id="notice"><%= notice %></p>
		
		<div id="chat-heading">
			<h2>Chatrooms</h2>
		</div>

		<p>
		  <strong>Name:</strong>
		  <%= @chatroom.name %>
		</p>

		<%= link_to 'Edit', edit_chatroom_path(@chatroom), class: "chat-btn" %> |
		<%= link_to 'Back', chatrooms_path, class: "chat-btn" %>



	<!-- User list section
 -->
	<br>

	<hr>
	 <ul class="current-chatrooms">
	  <% (User.all -  [current_user]).each do |user| %>
	    <li><%= link_to image_tag(user.profile_picture.url(:thumb)), direct_message_path(user.id), :method => :get, data: {behavior: "chatroom-link", chatroom_id: Chatroom.direct_message_for_users([current_user, user]).id } %></li>


	     


	     <link_to
	  <% end %>
	</ul>


	</div> <!-- end of sidebar -->





	<div class="chat-section">
		<strong><%= @chatroom.name  %></strong>
		<hr>
		<% unread_messages = false %>
		<div data-behavior='messages' data-chatroom-id='<%= @chatroom.id  %>'>


			<% @messages.each do |message| %>
    			<% if !unread_messages && @chatroom_user.last_read_at < message.created_at %>
      				<% unread_messages = true %>
     				 <div class="strike"><span>Unread Messages</span></div>
   				 <% end %>
					<%= render message  %>
			<% end %>

			



		</div>
		<br>
		<div class="text-area">
			<div id="text-box">
			<%= form_for [@chatroom, Message.new], remote: true do |f| %>
					<%= f.text_area :body, rows: 1, class: "form-control", autofocus: true, id: "text-box"  %>
			</div>

					
					<%= f.submit "Send", class: "btn btn-primary send-btn"  %>
			<% end %>
		</div>
	</div>
	



	



</div>
<!-- end of wrapper -->


